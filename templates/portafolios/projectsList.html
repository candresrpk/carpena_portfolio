{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container py-5 position-relative">
  <h1 class="text-center mb-4">Mis Proyectos</h1>

  <!-- Filtro por Tags -->
  <div class="mb-4 d-flex flex-wrap justify-content-center gap-2">
    <a href="{% url 'portafolios:projectsList' %}" class="btn btn-outline-secondary btn-sm {% if not request.GET.tag %}active{% endif %}">
      Todos
    </a>
    {% for tag in tags %}
      <a href="?tag={{ tag.name }}" class="btn btn-outline-success btn-sm {% if request.GET.tag == tag.name %}active{% endif %}">
        {{ tag.name }}
      </a>
    {% endfor %}
  </div>

  <!-- Grilla de Proyectos -->
  <div class="row g-4">
    {% for proyecto in projects %}
        <div class="col-sm-6 col-lg-4">
            <div class="card h-100 shadow border-0">
                <img src="{{ proyecto.image.url }}" class="card-img-top h-50" alt="{{proyecto.title}}">

                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">{{ proyecto.title }}</h5>
                    <p class="card-text truncate-text">
                        {{ proyecto.description }}
                    </p>
                    <p class="text-muted small mt-auto">Fecha: {{ proyecto.created_at }}</p>
                </div>

                <div class="card-footer bg-white border-top-0 d-flex justify-content-between">
                    <a href="{{ proyecto.github_url }}" class="btn btn-outline-success btn-sm" target="_blank">
                        <i class="bi bi-github"></i>
                    </a>
                    {% comment %} <a href="{% url 'proyectos:detalle' proyecto.slug %}" class="btn btn-success btn-sm"> {% endcomment %}
                    <a href="#" class="btn btn-success btn-sm">
                        <i class="bi bi-eye"></i> Ver más
                    </a>
                </div>
            </div>
        </div>

        {% empty %}
        <div class="col-12 text-center text-muted">
            <p>No hay proyectos disponibles para esta etiqueta.</p>
        </div>
        
    {% endfor %}
  </div>

  <!-- Botón flotante para agregar proyecto -->
  {% if request.user.is_authenticated  %}
    <a href="#" 
       class="btn btn-success rounded-circle position-fixed"
       style="bottom: 30px; right: 30px; width: 56px; height: 56px; display: flex; align-items: center; justify-content: center;"
       title="Agregar Proyecto">
      <i class="bi bi-plus-lg fs-4 text-white"></i>
    </a>
  {% endif %}
</div>

<style>
  .truncate-text {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;  
    overflow: hidden;
  }
</style>
{% endblock %}